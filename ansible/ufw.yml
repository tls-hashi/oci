- name: Configure UFW rules for reverse proxy
  hosts: reverse_proxies
  become: true
  tasks:
    - name: Install UFW
      apt:
        name: ufw
        state: present
        update_cache: true
      # Ensures UFW is installed on the host

    - name: Allow HTTP traffic on port 80
      ufw:
        rule: allow
        port: "80"
        proto: tcp
      # Allow incoming HTTP traffic

    - name: Allow HTTPS traffic on port 443
      ufw:
        rule: allow
        port: "443"
        proto: tcp
      # Optionally allow HTTPS if required

    - name: Enable UFW if not already enabled
      ufw:
        state: enabled
      # Enable UFW to enforce the rules